

/***************************************************
 * MADX
 *
 * Qh=26.66, QV=26.58 - qsplit at extraction -
 * Natural chromaticity in the H-plane and low positive chromaticity in the V-plane
 * SPS Shared slow extraction north (west extraction does not exist any more)
 *
 * ft_qs_ext.str is presently used for the fixed target
 * slow extraction at top energy (400 GeV/c)
 *
 * Call the file by: >madx < ft_qs_ext.madx
 ***************************************************/

 option, -echo;



/***************************************************
 * SPECIFY THE SPS BEAM CONFIGURATION, ENERGY and EMITTANCES
 ***************************************************/
 call, file = '../beams/cngs_after_capture.beamx';


/***************************************************
 * files for SPS
 ***************************************************/
 call, file = '../elements/sps.ele';
 call, file = '../aperture/aperturedb_1.dbx';
 call, file = '../aperture/aperturedb_2.dbx';
 call, file = '../sequence/sps.seq';
 call, file = '../aperture/aperturedb_3.dbx';
 call, file = '../strength/ft_qs_ext.str';
 call, file = '../strength/elements.str';
 option, echo;


/***************************************************
 * SEQEDIT
 * Junction between TT10 and SPS
 ***************************************************/
/*
 SEQEDIT, SEQUENCE=SPS;
 ENDTT10 : MARKER;
 install, element = ENDTT10, at = -0.1375, from = BPH.12008;
 ENDEDIT;

 SEQEDIT, SEQUENCE=SPS;
 ENDVKNV : MARKER;
 install, element = ENDVKNV, at = 10.3015+0.1755, from = BPD.11833;
 ENDEDIT;

 SEQEDIT, SEQUENCE=SPS;
 flatten ; cycle, start=  ENDVKNV;
 ENDEDIT;
*/




/***************************************************
 * use
 ***************************************************/
 use, sequence=SPS;


/***************************************************
 * TWISS
 ***************************************************/
 set,  format="11.8f";
 set,  format="-18s";

 select, flag=twiss, clear;
 select, flag=twiss
       , column=name,s,x,px,alfx,betx,dx,mux,y,py,alfy,bety,dy,muy;
 twiss, DELTAP=0.000,  centre;


/***************************************************
 * Write twiss table.
 ***************************************************/
 write,table=twiss,file="../out/optics_ft_qs_ext.outx";

!write,table=twiss;
!value,table(twiss,SPS$END,dx);



 stop;





