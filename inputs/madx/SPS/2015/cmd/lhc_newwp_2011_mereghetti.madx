

/***************************************************
 * MADX
 *
 * This madx file is used for:
 * ! Qh=26.13, QV=26.18 - no qsplit - chromaticity (0.0/0.0)  - SPS units
 * LHC settings 2007
 * lhc_newwp_2011.str is used for the LHC beam:
 * 1) at injection (26 GeV/c, not 14)
 * 2) during the ramp
 * 3) and at extraction (450 GeV/c)
 *
 * Call the file by: >madx < lhc_newwp_2011.madx
 ***************************************************/

 option, -echo;



/***************************************************
 * SPECIFY THE SPS BEAM CONFIGURATION, ENERGY and EMITTANCES
 ***************************************************/

 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /beams/lhc_beam_injection.beamx';



/***************************************************
 * 2011 files for SPS
 ***************************************************/

 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /elements/sps2011.ele';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /aperture/aperturedb_1_2011.dbx';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /aperture/aperturedb_2_2011.dbx';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /sequence/sps2011.seq';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /aperture/aperturedb_3_2011.dbx';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /strength/lhc_newwp_2011.str';
 call, file = '/afs/cern.ch/eng/sps/optics2011/SPS/SPSRing/2011
               /strength/elements.str';
 option, echo;


/***************************************************
 * SEQEDIT
 * Junction between TT10 and SPS
 ***************************************************/

/*
SEQEDIT, SEQUENCE=SPS;
ENDTT10 : MARKER;
install, element = ENDTT10, at = -0.1375, from = BPH.12008;
ENDEDIT;

SEQEDIT, SEQUENCE=SPS;
ENDVKNV : MARKER;
install, element = ENDVKNV, at = 10.3015+0.1755, from = BPD.11833;
ENDEDIT;

SEQEDIT, SEQUENCE=SPS;
flatten ; cycle, start=  ENDVKNV;
ENDEDIT;
*/



/***************************************************
 * use
 ***************************************************/

 use, sequence=SPS;




/***************************************************
 * TWISS
 ***************************************************/

 set,  format="13.9f";
 set,  format="-18s";

 select, flag=twiss, clear;
 select, flag=twiss
       , column=NAME,PARENT,APERTYPE,APER_1,APER_2,APER_3,APER_4,S,BETX,ALFX,MUX,DX,DPX,BETY,ALFY,MUY,DY,DPY,X,PX,Y,PY,K0L,K0SL,K1L,K1SL,K2L,K2SL;

 twiss, DELTAP=0.000,  centre;
!twiss, DELTAP=0.000;


/***************************************************
 * Write twiss table.
 ***************************************************/

 write,table=twiss,file="./optics_lhc_newwp_2011.outx";

!write,table=twiss;
!value,table(twiss,SPS$END,dx);




 stop;





